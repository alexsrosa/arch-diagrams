<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2302px" preserveAspectRatio="none" style="width:1294px;height:2302px;background:#FFFFFF;" version="1.1" viewBox="0 0 1294 2302" width="1294px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="532" x="379.75" y="37.1182">API Gateway Security with JWT Validation</text><rect fill="#FFFFFF" height="1166.1846" style="stroke:#000000;stroke-width:1.0;" width="10" x="466" y="451.5444"/><rect fill="#FFFFFF" height="88.3979" style="stroke:#000000;stroke-width:1.0;" width="10" x="717" y="273.7485"/><rect fill="#FFFFFF" height="45.5986" style="stroke:#000000;stroke-width:1.0;" width="10" x="717" y="788.5049"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="891" y="1155.896"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1026.5" y="1246.6626"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1177" y="1337.4292"/><rect fill="#FFFFFF" height="288.9604" style="stroke:#000000;stroke-width:1.0;" width="429" x="399.5" y="553.1431"/><rect fill="#FFFFFF" height="106.5659" style="stroke:none;stroke-width:1.0;" width="429" x="399.5" y="735.5376"/><rect fill="#FFFFFF" height="754.6255" style="stroke:#000000;stroke-width:1.0;" width="1115.5" x="162" y="856.1035"/><rect fill="#FFFFFF" height="274.7305" style="stroke:#000000;stroke-width:1.0;" width="868" x="399.5" y="1100.498"/><rect fill="#FFFFFF" height="90.7666" style="stroke:none;stroke-width:1.0;" width="868" x="399.5" y="1193.6953"/><rect fill="#FFFFFF" height="90.7666" style="stroke:none;stroke-width:1.0;" width="868" x="399.5" y="1284.4619"/><rect fill="#FFFFFF" height="60.9673" style="stroke:none;stroke-width:1.0;" width="1115.5" x="162" y="1427.8271"/><rect fill="#FFFFFF" height="60.9673" style="stroke:none;stroke-width:1.0;" width="1115.5" x="162" y="1488.7944"/><rect fill="#FFFFFF" height="60.9673" style="stroke:none;stroke-width:1.0;" width="1115.5" x="162" y="1549.7617"/><line style="stroke:#000000;stroke-width:1.0;" x1="237" x2="237" y1="130.752" y2="2220.9092"/><line style="stroke:#000000;stroke-width:1.0;" x1="470.5" x2="470.5" y1="130.752" y2="2220.9092"/><line style="stroke:#000000;stroke-width:1.0;" x1="721.5" x2="721.5" y1="130.752" y2="2220.9092"/><line style="stroke:#000000;stroke-width:1.0;" x1="895.5" x2="895.5" y1="130.752" y2="2220.9092"/><line style="stroke:#000000;stroke-width:1.0;" x1="1031.5" x2="1031.5" y1="130.752" y2="2220.9092"/><line style="stroke:#000000;stroke-width:1.0;" x1="1181.5" x2="1181.5" y1="130.752" y2="2220.9092"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="124" x="172" y="127.8125">Client Application</text><ellipse cx="237" cy="61.7373" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1.0;"/><path d="M237,69.7373 L237,96.7373 M224,77.7373 L250,77.7373 M237,96.7373 L224,111.7373 M237,96.7373 L250,111.7373 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="124" x="172" y="2233.9844">Client Application</text><ellipse cx="237" cy="2245.9238" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1.0;"/><path d="M237,2253.9238 L237,2280.9238 M224,2261.9238 L250,2261.9238 M237,2280.9238 L224,2295.9238 M237,2280.9238 L250,2295.9238 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="103" x="419.5" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89" x="426.5" y="119.8125">API Gateway</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="103" x="419.5" y="2219.9092"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89" x="426.5" y="2240.9844">API Gateway</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="173" x="635.5" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="159" x="642.5" y="119.8125">Authentication Service</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="173" x="635.5" y="2219.9092"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="159" x="642.5" y="2240.9844">Authentication Service</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="101" x="845.5" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="87" x="852.5" y="119.8125">User Service</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="101" x="845.5" y="2219.9092"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="87" x="852.5" y="2240.9844">User Service</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="110" x="976.5" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96" x="983.5" y="119.8125">Order Service</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="110" x="976.5" y="2219.9092"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96" x="983.5" y="2240.9844">Order Service</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="131" x="1116.5" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117" x="1123.5" y="119.8125">Payment Service</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="131" x="1116.5" y="2219.9092"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117" x="1123.5" y="2240.9844">Payment Service</text><rect fill="#FFFFFF" height="1166.1846" style="stroke:#000000;stroke-width:1.0;" width="10" x="466" y="451.5444"/><rect fill="#FFFFFF" height="88.3979" style="stroke:#000000;stroke-width:1.0;" width="10" x="717" y="273.7485"/><rect fill="#FFFFFF" height="45.5986" style="stroke:#000000;stroke-width:1.0;" width="10" x="717" y="788.5049"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="891" y="1155.896"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1026.5" y="1246.6626"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="1177" y="1337.4292"/><path d="M169,145.752 L169,186.752 L1249,186.752 L1249,155.752 L1239,145.752 L169,145.752 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M1239,145.752 L1239,155.752 L1249,155.752 L1239,145.752 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="327" x="532.25" y="163.8218">API Gateway acts as security enforcement point,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="345" x="532.25" y="179.6211">validating JWTs before forwarding to microservices</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1282.5" x="5" y="213.2502"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="213.2502" y2="213.2502"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="216.2502" y2="216.2502"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1.0;" width="147" x="572.75" y="202.3506"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129" x="578.75" y="219.4204">Token Acquisition</text><polygon fill="#000000" points="705,269.7485,715,273.7485,705,277.7485,709,273.7485" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="237" x2="711" y1="273.7485" y2="273.7485"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="108" x="244" y="253.2197">1. Login request</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151" x="244" y="269.019">(username, password)</text><line style="stroke:#000000;stroke-width:1.0;" x1="727" x2="769" y1="303.5479" y2="303.5479"/><line style="stroke:#000000;stroke-width:1.0;" x1="769" x2="769" y1="303.5479" y2="316.5479"/><line style="stroke:#000000;stroke-width:1.0;" x1="728" x2="769" y1="316.5479" y2="316.5479"/><polygon fill="#000000" points="738,312.5479,728,316.5479,738,320.5479,734,316.5479" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150" x="734" y="298.8184">2. Validate credentials</text><polygon fill="#000000" points="248,358.1465,238,362.1465,248,366.1465,244,362.1465" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="242" x2="721" y1="362.1465" y2="362.1465"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="87" x="254" y="341.6177">3. JWT token</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="180" x="254" y="357.417">(access_token, expires_in)</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1282.5" x="5" y="391.0461"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="391.0461" y2="391.0461"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="394.0461" y2="394.0461"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1.0;" width="172" x="560.25" y="380.1465"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="566.25" y="397.2163">Secured API Request</text><polygon fill="#000000" points="454,447.5444,464,451.5444,454,455.5444,458,451.5444" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="237" x2="460" y1="451.5444" y2="451.5444"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="95" x="244" y="431.0156">4. API request</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="210" x="244" y="446.8149">(Authorization: Bearer &lt;JWT&gt;)</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1282.5" x="5" y="480.4441"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="480.4441" y2="480.4441"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="483.4441" y2="483.4441"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1.0;" width="214" x="539.25" y="469.5444"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196" x="545.25" y="486.6143">JWT Validation at Gateway</text><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="518" y1="525.1431" y2="525.1431"/><line style="stroke:#000000;stroke-width:1.0;" x1="518" x2="518" y1="525.1431" y2="538.1431"/><line style="stroke:#000000;stroke-width:1.0;" x1="477" x2="518" y1="538.1431" y2="538.1431"/><polygon fill="#000000" points="487,534.1431,477,538.1431,487,542.1431,483,538.1431" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="185" x="483" y="520.4136">5. Extract JWT from header</text><path d="M399.5,553.1431 L463.5,553.1431 L463.5,560.9424 L453.5,570.9424 L399.5,570.9424 L399.5,553.1431 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="288.9604" style="stroke:#000000;stroke-width:1.0;" width="429" x="399.5" y="553.1431"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="414.5" y="567.2129">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="273" x="478.5" y="566.2021">[JWT Validation Method 1: Local Validation]</text><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="518" y1="608.541" y2="608.541"/><line style="stroke:#000000;stroke-width:1.0;" x1="518" x2="518" y1="608.541" y2="621.541"/><line style="stroke:#000000;stroke-width:1.0;" x1="477" x2="518" y1="621.541" y2="621.541"/><polygon fill="#000000" points="487,617.541,477,621.541,487,625.541,483,621.541" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179" x="483" y="588.0122">6a. Validate JWT signature</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120" x="483" y="603.8115">(using public key)</text><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="518" y1="714.5376" y2="714.5376"/><line style="stroke:#000000;stroke-width:1.0;" x1="518" x2="518" y1="714.5376" y2="727.5376"/><line style="stroke:#000000;stroke-width:1.0;" x1="477" x2="518" y1="727.5376" y2="727.5376"/><polygon fill="#000000" points="487,723.5376,477,727.5376,487,731.5376,483,727.5376" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="152" x="483" y="646.6108">7a. Check JWT claims:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="119" x="483" y="662.4102">- Expiration (exp)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="87" x="483" y="678.2095">- Issuer (iss)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="112" x="483" y="694.0088">- Audience (aud)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120" x="483" y="709.8081">- Not before (nbf)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="399.5" x2="828.5" y1="736.5376" y2="736.5376"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="289" x="404.5" y="747.5967">[JWT Validation Method 2: Remote Validation]</text><polygon fill="#000000" points="705,784.5049,715,788.5049,705,792.5049,709,788.5049" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="711" y1="788.5049" y2="788.5049"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="112" x="483" y="767.9761">6b. Validate JWT</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="140" x="483" y="783.7754">(token introspection)</text><polygon fill="#000000" points="487,830.1035,477,834.1035,487,838.1035,483,834.1035" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="481" x2="721" y1="834.1035" y2="834.1035"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179" x="493" y="813.5747">7b. Token validation result</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159" x="493" y="829.374">(active, scope, user_id)</text><path d="M162,856.1035 L226,856.1035 L226,863.9028 L216,873.9028 L162,873.9028 L162,856.1035 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="754.6255" style="stroke:#000000;stroke-width:1.0;" width="1115.5" x="162" y="856.1035"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="177" y="870.1733">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="72" x="241" y="869.1626">[JWT Valid]</text><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="518" y1="911.5015" y2="911.5015"/><line style="stroke:#000000;stroke-width:1.0;" x1="518" x2="518" y1="911.5015" y2="924.5015"/><line style="stroke:#000000;stroke-width:1.0;" x1="477" x2="518" y1="924.5015" y2="924.5015"/><polygon fill="#000000" points="487,920.5015,477,924.5015,487,928.5015,483,924.5015" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="161" x="483" y="890.9727">8a. Extract user context</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="194" x="483" y="906.772">(user_id, roles, permissions)</text><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="518" y1="970.1001" y2="970.1001"/><line style="stroke:#000000;stroke-width:1.0;" x1="518" x2="518" y1="970.1001" y2="983.1001"/><line style="stroke:#000000;stroke-width:1.0;" x1="477" x2="518" y1="983.1001" y2="983.1001"/><polygon fill="#000000" points="487,979.1001,477,983.1001,487,987.1001,483,983.1001" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150" x="483" y="949.5713">9a. Apply rate limiting</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110" x="483" y="965.3706">(per user/client)</text><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="518" y1="1028.6987" y2="1028.6987"/><line style="stroke:#000000;stroke-width:1.0;" x1="518" x2="518" y1="1028.6987" y2="1041.6987"/><line style="stroke:#000000;stroke-width:1.0;" x1="477" x2="518" y1="1041.6987" y2="1041.6987"/><polygon fill="#000000" points="487,1037.6987,477,1041.6987,487,1045.6987,483,1041.6987" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="186" x="483" y="1008.1699">10a. Check API permissions</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184" x="483" y="1023.9692">(route-based authorization)</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1282.5" x="5" y="1070.5984"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="1070.5984" y2="1070.5984"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="1073.5984" y2="1073.5984"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1.0;" width="192" x="550.25" y="1059.6987"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174" x="556.25" y="1076.7686">Forward to Microservice</text><path d="M399.5,1100.498 L463.5,1100.498 L463.5,1108.2974 L453.5,1118.2974 L399.5,1118.2974 L399.5,1100.498 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="274.7305" style="stroke:#000000;stroke-width:1.0;" width="868" x="399.5" y="1100.498"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="414.5" y="1114.5679">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="160" x="478.5" y="1113.5571">[Request to User Service]</text><polygon fill="#000000" points="879,1151.896,889,1155.896,879,1159.896,883,1155.896" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="885" y1="1155.896" y2="1155.896"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143" x="483" y="1135.3672">11a. Forward request</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="483" y="1151.1665">(+ user context headers)</text><polygon fill="#000000" points="487,1181.6953,477,1185.6953,487,1189.6953,483,1185.6953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="481" x2="895" y1="1185.6953" y2="1185.6953"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131" x="493" y="1180.9658">12a. Response data</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="399.5" x2="1267.5" y1="1194.6953" y2="1194.6953"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="166" x="404.5" y="1205.7544">[Request to Order Service]</text><polygon fill="#000000" points="1014.5,1242.6626,1024.5,1246.6626,1014.5,1250.6626,1018.5,1246.6626" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="1020.5" y1="1246.6626" y2="1246.6626"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143" x="483" y="1226.1338">11b. Forward request</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="483" y="1241.9331">(+ user context headers)</text><polygon fill="#000000" points="487,1272.4619,477,1276.4619,487,1280.4619,483,1276.4619" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="481" x2="1030.5" y1="1276.4619" y2="1276.4619"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131" x="493" y="1271.7324">12b. Response data</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="399.5" x2="1267.5" y1="1285.4619" y2="1285.4619"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="186" x="404.5" y="1296.521">[Request to Payment Service]</text><polygon fill="#000000" points="1165,1333.4292,1175,1337.4292,1165,1341.4292,1169,1337.4292" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="476" x2="1171" y1="1337.4292" y2="1337.4292"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142" x="483" y="1316.9004">11c. Forward request</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="483" y="1332.6997">(+ user context headers)</text><polygon fill="#000000" points="487,1363.2285,477,1367.2285,487,1371.2285,483,1367.2285" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="481" x2="1181" y1="1367.2285" y2="1367.2285"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="130" x="493" y="1362.499">12c. Response data</text><polygon fill="#000000" points="248,1415.8271,238,1419.8271,248,1423.8271,244,1419.8271" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="242" x2="465" y1="1419.8271" y2="1419.8271"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121" x="254" y="1399.2983">13a. API response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="112" x="254" y="1415.0977">(requested data)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="162" x2="1277.5" y1="1428.8271" y2="1428.8271"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="167" y="1439.8862">[JWT Invalid/Expired]</text><polygon fill="#000000" points="248,1476.7944,238,1480.7944,248,1484.7944,244,1480.7944" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="242" x2="465" y1="1480.7944" y2="1480.7944"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143" x="254" y="1460.2656">8b. 401 Unauthorized</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="185" x="254" y="1476.0649">("Invalid or expired token")</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="162" x2="1277.5" y1="1489.7944" y2="1489.7944"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="166" x="167" y="1500.8535">[Insufficient Permissions]</text><polygon fill="#000000" points="248,1537.7617,238,1541.7617,248,1545.7617,244,1541.7617" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="242" x2="465" y1="1541.7617" y2="1541.7617"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="119" x="254" y="1521.2329">8c. 403 Forbidden</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183" x="254" y="1537.0322">("Insufficient permissions")</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="162" x2="1277.5" y1="1550.7617" y2="1550.7617"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="138" x="167" y="1561.8208">[Rate Limit Exceeded]</text><polygon fill="#000000" points="248,1598.729,238,1602.729,248,1606.729,244,1602.729" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="242" x2="465" y1="1602.729" y2="1602.729"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184" x="254" y="1582.2002">8d. 429 Too Many Requests</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157" x="254" y="1597.9995">("Rate limit exceeded")</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1282.5" x="5" y="1638.6287"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="1638.6287" y2="1638.6287"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1287.5" y1="1641.6287" y2="1641.6287"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1.0;" width="168" x="562.25" y="1627.729"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="568.25" y="1644.7988">Audit and Monitoring</text><line style="stroke:#000000;stroke-width:1.0;" x1="471" x2="513" y1="1699.127" y2="1699.127"/><line style="stroke:#000000;stroke-width:1.0;" x1="513" x2="513" y1="1699.127" y2="1712.127"/><line style="stroke:#000000;stroke-width:1.0;" x1="472" x2="513" y1="1712.127" y2="1712.127"/><polygon fill="#000000" points="482,1708.127,472,1712.127,482,1716.127,478,1712.127" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153" x="478" y="1678.5981">14. Log request details</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="237" x="478" y="1694.3975">(user_id, endpoint, response_code)</text><path d="M476,1725.127 L476,1861.127 L696,1861.127 L696,1735.127 L686,1725.127 L476,1725.127 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M686,1725.127 L686,1735.127 L696,1735.127 L686,1725.127 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="186" x="482" y="1743.1968">Gateway Security Features:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175" x="482" y="1758.9961">- JWT signature validation</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="186" x="482" y="1774.7954">- Token expiration checking</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="199" x="482" y="1790.5947">- Rate limiting per user/client</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="186" x="482" y="1806.394">- Route-based authorization</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183" x="482" y="1822.1934">- Request/response logging</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109" x="482" y="1837.9927">- CORS handling</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137" x="482" y="1853.792">- Request size limits</text><path d="M727,1871.5215 L727,2007.5215 L901,2007.5215 L901,1881.5215 L891,1871.5215 L727,1871.5215 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M891,1871.5215 L891,1881.5215 L901,1881.5215 L891,1871.5215 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="83" x="733" y="1889.5913">JWT Claims:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153" x="733" y="1905.3906">- sub (subject/user_id)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="86" x="733" y="1921.1899">- iss (issuer)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111" x="733" y="1936.9893">- aud (audience)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="119" x="733" y="1952.7886">- exp (expiration)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105" x="733" y="1968.5879">- iat (issued at)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="146" x="733" y="1984.3872">- scope (permissions)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128" x="733" y="2000.1865">- roles (user roles)</text><path d="M10,2017.916 L10,2105.916 L232,2105.916 L232,2027.916 L222,2017.916 L10,2017.916 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M222,2017.916 L222,2027.916 L232,2027.916 L222,2017.916 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="152" x="16" y="2035.9858">Client Responsibilities:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154" x="16" y="2051.7852">- Secure token storage</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165" x="16" y="2067.5845">- Token refresh handling</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="155" x="16" y="2083.3838">- Proper error handling</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201" x="16" y="2099.1831">- Include token in all requests</text><path d="M830,2116.9126 L830,2204.9126 L1247,2204.9126 L1247,2126.9126 L1237,2116.9126 L830,2116.9126 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M1237,2116.9126 L1237,2126.9126 L1247,2126.9126 L1237,2116.9126 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156" x="920.5" y="2134.9824">Microservices Benefits:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217" x="920.5" y="2150.7817">- No authentication logic needed</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217" x="920.5" y="2166.5811">- Receive validated user context</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167" x="920.5" y="2182.3804">- Focus on business logic</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="227" x="920.5" y="2198.1797">- Consistent security enforcement</text><!--SRC=[fLTDRnit4BthLqnrab7BZcmtJOGwW6lKXOCuCPIalGGmAEv8OhqY5P9hM_trVIHt9UvQQWB41raYPsVclVdSd_o2bqohKYZTyygNJ1Utr_IdyFmerlIHPMMLNzEZyWjw-_Sd-akKgX1U6Tth2UcDfVvbgLXxkbYjIYNZLP-48ncFUojXlP9g9I3IptH7cNdwtX6gu9JsjIxuO1-Kv2WlSDKM_kpOjaGg7BZqkotvmHOTKHDETihUYlKoOCgbL-ciaUzfuvdC0tGcf8TT2MfH2R9SKECQIbdFZ9KSxQoCWW8yyL3Jg-U1RKTJXX0JFXw5BSAnDxHKqfhQYkknBYZuqkkTdzCdSy-QBkJNIZaLwJi_x_MIWpHy4maSq-Y8tfcvqcJvQyNEVz63G9iMImued7i4DGSXlke1xYVQU-5pg-FagCa59ccv214JfMl489UiZkdqA6QE3wx1af3msjt5duV4JojbsTqfVT0hk6CHW686SX6fd2HlEv3g71hJsL6Ksc8AYMIi-ZVcqPX-Ps4HhT_Wp9iCN9E3mLexmqduJVY2pLgoPVIN8_hZoLjeYm_Fh5dIWWKI2qoKlglnXk5IGQCn0Y15cPSJuM-NXPSYOpgeSsgkXGShCMmX9rRL5AL7zxm-Y6hswleLkYuNBE-Z8ecgNxhn5pq41eGXkJX0I0x2sRLp5VWQAEVYxukg0EUIQI2g8fwyDxx9q86UpchZN3hUW_jaZ20kG-7i1vxIw-MqZHfOOyOG2WN9ls8PdaqMsraJJveSt2A7lbGS3rkla7XLwMDEGWDotqcpmhzG37UgIDgxMObwwuHsBzsln3OxWawIHdj-QkeD9Wx9cf8Tgexj4aJ3A_UD6Bw6qj1hrsI3JwLQgj0le1CwefdZL1pVq3DwiKc6K3QP0r1bJULvE1KEfIVoCigKebwkKbyAJUacQqgXMZPYWQgcSY6ND-nut_4lwz_mSGGV6oFRmlwvnMPTRpLlhOJ8Xq5pcPsrKsHq0cCJTYjGm8GK4PjdiXpOfJ9-YMcV0MtDcrr8y_4Je4v_26fhc3Mt-M4NxFGxmEvKkXDjPsBkmjiUZm6n_274pyPj-ciVTr7Bxq2zGt4e-kVLb0svqQbena_I7eeeOK891KlTxdYjOoSwZgsNYxsQNo5GPoz6z5atXSW5bFVhvn6ZUeWMQSJsSqFNsbMp6VQQ49lRROdljoQ3jTCGbwagYZYn-oqjMQDecPe4wjw5ReIU9naRmVzWAc3bv3KwCXg7qEicaqBhwKysRGt0aY8OYcqt2r8-jiDayYIm2DqOhR2KXg6uRsAFpkBsqsGS0k-5AbtUas4hRMIRQDv9K_11lVHPDLzuChED3_HyORxYEABT69V3zjZE9b2yJ6E9jnDOXgOC2F5saZTvwhJu9B6lLwVR1FEuGKAbcSyRvPSV9Xzf0UBAZRcQ5OSqIsRp3RCDlnwt0TnbMYMY2bTDQO2FVp2ZZxDHEYIaJLmdi5Qa0omISPk8UqKw0Wzn1Qd9g1_49fOU14IVpkAifa5dS0xJGAKOpFJze0kWv5dqVyDX_GPJDmOrLINORcANDj1KM-IGN6BEMTmipq3jeitYhJKXKcmjghDrSwrbMHMDEgpWeYoRL7p6T7oxo0REZbUCVEmwhBYQPmXPylozYI7AtgKGU-o9kYdE46x9s7oQb0IzUVED8bT6LdXNqZGDooPMzwGbvK-W2nqEvErwhzdY-Gy0]--></g></svg>